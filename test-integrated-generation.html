<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ­ãƒ¼ã‚«ãƒ«AIä¸€æ‹¬ç”Ÿæˆ æ¤œè¨¼ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e8e8e8;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 16px;
        }

        .status-ready {
            background: #10b981;
        }

        .status-unavailable {
            background: #f59e0b;
        }

        .status-error {
            background: #ef4444;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px 4px;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        pre {
            background: #0d1117;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 12px;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .metric {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .metric-label {
            font-size: 12px;
            color: #888;
        }

        .streaming-output {
            font-family: monospace;
            white-space: pre-wrap;
            line-height: 1.6;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ§ª ãƒ­ãƒ¼ã‚«ãƒ«AI ä¸€æ‹¬ç”Ÿæˆ æ¤œè¨¼ãƒ„ãƒ¼ãƒ«</h1>

        <div class="card">
            <div id="statusBadge" class="status-badge">æ¤œè¨¼ä¸­...</div>
            <h3>AIçŠ¶æ…‹</h3>
            <p id="aiStatus">ç¢ºèªä¸­...</p>
        </div>

        <div class="card">
            <h3>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆ23é …ç›®ã‚µãƒ³ãƒ—ãƒ«ï¼‰</h3>
            <div class="metrics">
                <div class="metric">
                    <div class="metric-value" id="categoryCount">0</div>
                    <div class="metric-label">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚«ãƒ†ã‚´ãƒª</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="tokenEstimate">0</div>
                    <div class="metric-label">æ¨å®šãƒˆãƒ¼ã‚¯ãƒ³æ•°</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="promptLength">0</div>
                    <div class="metric-label">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ–‡å­—æ•°</div>
                </div>
            </div>
            <button onclick="showTestData()">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º</button>
            <button onclick="showCompressedPrompt()">åœ§ç¸®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¡¨ç¤º</button>
            <pre id="dataOutput" style="display: none;"></pre>
        </div>

        <div class="card">
            <h3>ä¸€æ‹¬ç”Ÿæˆãƒ†ã‚¹ãƒˆ</h3>
            <button id="testBtn" onclick="runIntegratedTest()" disabled>
                ğŸš€ ãƒ­ãƒ¼ã‚«ãƒ«AIã§ä¸€æ‹¬ç”Ÿæˆãƒ†ã‚¹ãƒˆ
            </button>
            <button id="apiTestBtn" onclick="runAPITest()">
                ğŸ”‘ APIï¼ˆBYOKï¼‰ã§ãƒ†ã‚¹ãƒˆ
            </button>
            <div class="metrics" style="margin-top: 16px;">
                <div class="metric">
                    <div class="metric-value" id="genTime">-</div>
                    <div class="metric-label">ç”Ÿæˆæ™‚é–“(ms)</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="outputTokens">-</div>
                    <div class="metric-label">å‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³æ¨å®š</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>ç”Ÿæˆçµæœï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°è¡¨ç¤ºï¼‰</h3>
            <pre id="resultOutput" class="streaming-output">çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...</pre>
        </div>

        <div class="card">
            <h3>å“è³ªæ¤œè¨¼</h3>
            <pre id="qualityCheck">ç”Ÿæˆå¾Œã«è‡ªå‹•æ¤œè¨¼ã•ã‚Œã¾ã™...</pre>
        </div>
    </div>

    <script>
        // ========================================
        // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆåšåŠ´çœ23é …ç›®ã‚µãƒ³ãƒ—ãƒ«ï¼‰
        // ========================================
        const TEST_ASSESSMENT = {
            meta: {
                serviceType: "facility",
                assessmentDate: "2026-01-31"
            },
            basicInfo: {
                careLevel: "è¦ä»‹è­·3",
                adlLevel: "B1",
                dementiaLevel: "IIa",
                diagnosis: "è„³æ¢—å¡å¾Œéºç—‡ã€é«˜è¡€åœ§ã€ç³–å°¿ç—…"
            },
            assessment: {
                healthStatus: {
                    checked: ["æŒç—…ã®ç®¡ç†ãŒå¿…è¦", "è¡€åœ§ç®¡ç†ãŒå¿…è¦", "æœè–¬ç®¡ç†ã«æ”¯æ´ãŒå¿…è¦"],
                    detail: "é«˜è¡€åœ§ï¼ˆ150/90mmHgç¨‹åº¦ï¼‰ã€ç³–å°¿ç—…ï¼ˆHbA1c 7.2%ï¼‰ã€‚æ¯æ—¥ã®æœè–¬ç®¡ç†ã¨è¡€åœ§æ¸¬å®šãŒå¿…è¦ã€‚"
                },
                adl: {
                    checked: ["æ­©è¡ŒãŒä¸å®‰å®š", "ç§»ä¹—ã«ä»‹åŠ©ãŒå¿…è¦"],
                    detail: "æ–æ­©è¡Œå¯èƒ½ã ãŒã€ãƒãƒ©ãƒ³ã‚¹ã‚’å´©ã—ã‚„ã™ã„ã€‚è»¢å€’æ­´ã‚ã‚Šï¼ˆ3ãƒ¶æœˆå‰ï¼‰ã€‚"
                },
                iadl: {
                    checked: ["è²·ã„ç‰©ãŒå›°é›£", "èª¿ç†ãŒå›°é›£", "é‡‘éŠ­ç®¡ç†ã«æ”¯æ´ãŒå¿…è¦"],
                    detail: null
                },
                cognition: {
                    checked: ["çŸ­æœŸè¨˜æ†¶ã®ä½ä¸‹"],
                    detail: "æ–°ã—ã„ã“ã¨ã‚’è¦šãˆã«ãã„ã€‚æ—¥ä»˜ã®æ··ä¹±ãŒã‚ã‚‹ã€‚"
                },
                communication: {
                    checked: [],
                    detail: null
                },
                socialParticipation: {
                    checked: ["å¤–å‡ºæ©Ÿä¼šã®æ¸›å°‘"],
                    detail: "ä»¥å‰ã¯æ¯æ—¥æ•£æ­©ã—ã¦ã„ãŸãŒã€è»¢å€’å¾Œã¯å¤–å‡ºã‚’æ€–ãŒã‚‹ã€‚"
                },
                excretion: {
                    checked: ["æ’æ³„ã®å¤±æ•—ãŒã‚ã‚‹"],
                    detail: "å¤œé–“ã®ãƒˆã‚¤ãƒ¬èª˜å°ãŒå¿…è¦ã€‚æ˜¼é–“ã¯è‡ªç«‹ã€‚"
                },
                eating: {
                    checked: [],
                    detail: null
                },
                mentalHealth: {
                    checked: ["æ„æ¬²ã®ä½ä¸‹"],
                    detail: "è»¢å€’å¾Œã€ãƒªãƒãƒ“ãƒªã¸ã®æ„æ¬²ãŒä½ä¸‹ã—ã¦ã„ã‚‹ã€‚"
                },
                housework: {
                    checked: ["æƒé™¤ãŒå›°é›£", "æ´—æ¿¯ãŒå›°é›£"],
                    detail: null
                },
                rehabilitation: {
                    checked: ["ãƒªãƒãƒ“ãƒªãŒå¿…è¦"],
                    detail: "æ­©è¡Œèƒ½åŠ›ã®ç¶­æŒãƒ»æ”¹å–„ãŒå¿…è¦ã€‚"
                },
                familySupport: {
                    checked: ["å®¶æ—ã®ä»‹è­·è² æ‹…"],
                    detail: "ä¸»ä»‹è­·è€…ï¼ˆæ¯å­ã®å¦»ï¼‰ãŒç–²åŠ´æ°—å‘³ã€‚"
                },
                livingEnvironment: {
                    checked: ["æ®µå·®ãŒã‚ã‚‹"],
                    detail: "ç„é–¢ã«15cmã®æ®µå·®ã€‚æ‰‹ã™ã‚Šæœªè¨­ç½®ã€‚"
                },
                specialNeeds: {
                    checked: [],
                    detail: null
                }
            }
        };

        // ========================================
        // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåœ§ç¸®é–¢æ•°
        // ========================================
        function compressAssessment(data) {
            const categoryNames = {
                healthStatus: "å¥åº·çŠ¶æ…‹",
                adl: "ADLï¼ˆæ—¥å¸¸ç”Ÿæ´»å‹•ä½œï¼‰",
                iadl: "IADLï¼ˆæ‰‹æ®µçš„æ—¥å¸¸ç”Ÿæ´»å‹•ä½œï¼‰",
                cognition: "èªçŸ¥æ©Ÿèƒ½",
                communication: "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
                socialParticipation: "ç¤¾ä¼šå‚åŠ ",
                excretion: "æ’æ³„",
                eating: "é£Ÿäº‹",
                mentalHealth: "ç²¾ç¥ãƒ»å¿ƒç†çŠ¶æ…‹",
                housework: "å®¶äº‹",
                rehabilitation: "ãƒªãƒãƒ“ãƒªãƒ†ãƒ¼ã‚·ãƒ§ãƒ³",
                familySupport: "å®¶æ—æ”¯æ´",
                livingEnvironment: "ä½ç’°å¢ƒ",
                specialNeeds: "ç‰¹åˆ¥ãªãƒ‹ãƒ¼ã‚º"
            };

            const items = [];
            for (const [key, val] of Object.entries(data.assessment)) {
                if (val.checked.length > 0 || val.detail) {
                    items.push({
                        category: categoryNames[key] || key,
                        issues: val.checked,
                        detail: val.detail
                    });
                }
            }
            return items;
        }

        // ========================================
        // åœ§ç¸®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
        // ========================================
        function buildCompressedPrompt(data) {
            const compressed = compressAssessment(data);
            const basic = data.basicInfo;

            let prompt = `ã€ã‚±ã‚¢ãƒ—ãƒ©ãƒ³ç¬¬2è¡¨ç”Ÿæˆã€‘
ä»‹è­·åº¦: ${basic.careLevel}
ADL: ${basic.adlLevel}
èªçŸ¥ç—‡: ${basic.dementiaLevel}
è¨ºæ–­: ${basic.diagnosis}

ã€ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆçµæœã€‘
`;

            compressed.forEach((item, i) => {
                prompt += `\n${i + 1}. ${item.category}`;
                if (item.issues.length > 0) {
                    prompt += `\n   èª²é¡Œ: ${item.issues.join('ã€')}`;
                }
                if (item.detail) {
                    prompt += `\n   è©³ç´°: ${item.detail}`;
                }
            });

            prompt += `

ã€å‡ºåŠ›å½¢å¼ã€‘
ä»¥ä¸‹ã®JSONé…åˆ—ã§${Math.min(compressed.length, 5)}ä»¶ã®ç¬¬2è¡¨é …ç›®ã‚’ç”Ÿæˆ:
[{"needs":"ãƒ‹ãƒ¼ã‚ºï¼ˆã€œã ãŒã€œã—ãŸã„ï¼‰","longTermGoal":"é•·æœŸç›®æ¨™ï¼ˆ55æ–‡å­—ä»¥å†…ï¼‰","shortTermGoal":"çŸ­æœŸç›®æ¨™ï¼ˆ55æ–‡å­—ä»¥å†…ï¼‰","serviceContent":"ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹"}]`;

            return prompt;
        }

        // ========================================
        // åˆæœŸåŒ–
        // ========================================
        let aiSession = null;
        let useLocalAI = false;

        async function init() {
            const statusBadge = document.getElementById('statusBadge');
            const aiStatus = document.getElementById('aiStatus');
            const testBtn = document.getElementById('testBtn');

            try {
                if ('ai' in window && 'languageModel' in window.ai) {
                    const capabilities = await window.ai.languageModel.capabilities();

                    if (capabilities.available === 'readily') {
                        aiSession = await window.ai.languageModel.create();
                        useLocalAI = true;
                        statusBadge.textContent = 'âœ… ãƒ­ãƒ¼ã‚«ãƒ«AIåˆ©ç”¨å¯èƒ½';
                        statusBadge.className = 'status-badge status-ready';
                        aiStatus.textContent = 'Gemini Nano (window.ai) ãŒåˆ©ç”¨å¯èƒ½ã§ã™';
                        testBtn.disabled = false;
                    } else if (capabilities.available === 'after-download') {
                        statusBadge.textContent = 'â³ AIãƒ¢ãƒ‡ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­';
                        statusBadge.className = 'status-badge status-unavailable';
                        aiStatus.textContent = 'ãƒ¢ãƒ‡ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...';
                        aiSession = await window.ai.languageModel.create();
                        useLocalAI = true;
                        statusBadge.textContent = 'âœ… ãƒ­ãƒ¼ã‚«ãƒ«AIåˆ©ç”¨å¯èƒ½';
                        statusBadge.className = 'status-badge status-ready';
                        testBtn.disabled = false;
                    } else {
                        throw new Error('ãƒ­ãƒ¼ã‚«ãƒ«AIéå¯¾å¿œ');
                    }
                } else {
                    throw new Error('Prompt APIæœªå¯¾å¿œ');
                }
            } catch (error) {
                statusBadge.textContent = 'âš ï¸ ãƒ­ãƒ¼ã‚«ãƒ«AIåˆ©ç”¨ä¸å¯';
                statusBadge.className = 'status-badge status-unavailable';
                aiStatus.textContent = `${error.message} - APIãƒ†ã‚¹ãƒˆã®ã¿å¯èƒ½`;
            }

            // ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ›´æ–°
            updateMetrics();
        }

        function updateMetrics() {
            const compressed = compressAssessment(TEST_ASSESSMENT);
            const prompt = buildCompressedPrompt(TEST_ASSESSMENT);

            document.getElementById('categoryCount').textContent = compressed.length;
            document.getElementById('promptLength').textContent = prompt.length;
            document.getElementById('tokenEstimate').textContent = Math.ceil(prompt.length / 3); // æ—¥æœ¬èªã¯ç´„3æ–‡å­—/ãƒˆãƒ¼ã‚¯ãƒ³
        }

        function showTestData() {
            const output = document.getElementById('dataOutput');
            output.style.display = output.style.display === 'none' ? 'block' : 'none';
            output.textContent = JSON.stringify(TEST_ASSESSMENT, null, 2);
        }

        function showCompressedPrompt() {
            const output = document.getElementById('dataOutput');
            output.style.display = 'block';
            output.textContent = buildCompressedPrompt(TEST_ASSESSMENT);
        }

        // ========================================
        // ãƒ­ãƒ¼ã‚«ãƒ«AIãƒ†ã‚¹ãƒˆ
        // ========================================
        async function runIntegratedTest() {
            if (!aiSession) {
                alert('ãƒ­ãƒ¼ã‚«ãƒ«AIãŒåˆ©ç”¨ã§ãã¾ã›ã‚“');
                return;
            }

            const resultOutput = document.getElementById('resultOutput');
            const qualityCheck = document.getElementById('qualityCheck');
            const genTimeEl = document.getElementById('genTime');
            const outputTokensEl = document.getElementById('outputTokens');

            resultOutput.textContent = 'ç”Ÿæˆä¸­... ğŸ”„\n\n';
            qualityCheck.textContent = 'æ¤œè¨¼å¾…ã¡...';

            const prompt = buildCompressedPrompt(TEST_ASSESSMENT);
            const startTime = performance.now();

            try {
                // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ç”Ÿæˆ
                const stream = await aiSession.promptStreaming(prompt);
                let fullResponse = '';

                for await (const chunk of stream) {
                    fullResponse = chunk; // ç´¯ç©ãƒ†ã‚­ã‚¹ãƒˆ
                    resultOutput.textContent = 'ç”Ÿæˆä¸­... ğŸ”„\n\n' + fullResponse;
                }

                const endTime = performance.now();
                genTimeEl.textContent = Math.round(endTime - startTime);
                outputTokensEl.textContent = Math.ceil(fullResponse.length / 3);

                resultOutput.textContent = 'âœ… ç”Ÿæˆå®Œäº†\n\n' + fullResponse;

                // å“è³ªæ¤œè¨¼
                validateOutput(fullResponse, qualityCheck);

            } catch (error) {
                resultOutput.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message;
                qualityCheck.textContent = 'æ¤œè¨¼ä¸å¯';
            }
        }

        // ========================================
        // APIãƒ†ã‚¹ãƒˆï¼ˆBYOKï¼‰
        // ========================================
        async function runAPITest() {
            const apiKey = prompt('Gemini APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (!apiKey) return;

            const resultOutput = document.getElementById('resultOutput');
            const qualityCheck = document.getElementById('qualityCheck');
            const genTimeEl = document.getElementById('genTime');
            const outputTokensEl = document.getElementById('outputTokens');

            resultOutput.textContent = 'APIå‘¼ã³å‡ºã—ä¸­... ğŸ”„\n\n';
            qualityCheck.textContent = 'æ¤œè¨¼å¾…ã¡...';

            const promptText = buildCompressedPrompt(TEST_ASSESSMENT);
            const startTime = performance.now();

            // ãƒ¢ãƒ‡ãƒ«é¸æŠï¼ˆ2024å¹´ä»¥é™ã®åˆ©ç”¨å¯èƒ½ãªãƒ¢ãƒ‡ãƒ«ï¼‰
            const modelName = 'gemini-1.5-flash';

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1/models/${modelName}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: promptText }] }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 2048
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData?.error?.message || `HTTPã‚¨ãƒ©ãƒ¼ ${response.status}`;
                    throw new Error(errorMessage);
                }

                const result = await response.json();
                const fullResponse = result.candidates?.[0]?.content?.parts?.[0]?.text || '';

                const endTime = performance.now();
                genTimeEl.textContent = Math.round(endTime - startTime);
                outputTokensEl.textContent = result.usageMetadata?.candidatesTokenCount || 'ä¸æ˜';

                resultOutput.textContent = `âœ… APIç”Ÿæˆå®Œäº† (${modelName})\n\n` + fullResponse;

                // å“è³ªæ¤œè¨¼
                validateOutput(fullResponse, qualityCheck);

            } catch (error) {
                resultOutput.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message + '\n\nãƒ’ãƒ³ãƒˆ:\n- APIã‚­ãƒ¼ãŒæ­£ã—ã„ã‹ç¢ºèª\n- 1åˆ†å¾…ã£ã¦å†è©¦è¡Œ\n- Google AI Studioã§èª²é‡‘çŠ¶æ…‹ã‚’ç¢ºèª';
                qualityCheck.textContent = 'æ¤œè¨¼ä¸å¯';
            }
        }

        // ========================================
        // å“è³ªæ¤œè¨¼
        // ========================================
        function validateOutput(text, outputEl) {
            const checks = [];

            // JSONæŠ½å‡º
            const jsonMatch = text.match(/\[[\s\S]*\]/);
            if (!jsonMatch) {
                outputEl.textContent = 'âŒ JSONãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“';
                return;
            }

            try {
                const parsed = JSON.parse(jsonMatch[0]);
                checks.push('âœ… JSONå½¢å¼: æ­£å¸¸');
                checks.push(`âœ… ç”Ÿæˆä»¶æ•°: ${parsed.length}ä»¶`);

                let hasNeeds = true, hasLong = true, hasShort = true, hasService = true;
                let longOver55 = 0, shortOver55 = 0;

                parsed.forEach((item, i) => {
                    if (!item.needs) hasNeeds = false;
                    if (!item.longTermGoal) hasLong = false;
                    if (!item.shortTermGoal) hasShort = false;
                    if (!item.serviceContent) hasService = false;
                    if (item.longTermGoal && item.longTermGoal.length > 55) longOver55++;
                    if (item.shortTermGoal && item.shortTermGoal.length > 55) shortOver55++;
                });

                checks.push(hasNeeds ? 'âœ… ãƒ‹ãƒ¼ã‚º: ã™ã¹ã¦å­˜åœ¨' : 'âš ï¸ ãƒ‹ãƒ¼ã‚º: ä¸€éƒ¨æ¬ è½');
                checks.push(hasLong ? 'âœ… é•·æœŸç›®æ¨™: ã™ã¹ã¦å­˜åœ¨' : 'âš ï¸ é•·æœŸç›®æ¨™: ä¸€éƒ¨æ¬ è½');
                checks.push(hasShort ? 'âœ… çŸ­æœŸç›®æ¨™: ã™ã¹ã¦å­˜åœ¨' : 'âš ï¸ çŸ­æœŸç›®æ¨™: ä¸€éƒ¨æ¬ è½');
                checks.push(hasService ? 'âœ… ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹: ã™ã¹ã¦å­˜åœ¨' : 'âš ï¸ ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹: ä¸€éƒ¨æ¬ è½');
                checks.push(longOver55 === 0 ? 'âœ… é•·æœŸç›®æ¨™æ–‡å­—æ•°: 55æ–‡å­—ä»¥å†…' : `âš ï¸ é•·æœŸç›®æ¨™: ${longOver55}ä»¶ãŒ55æ–‡å­—è¶…é`);
                checks.push(shortOver55 === 0 ? 'âœ… çŸ­æœŸç›®æ¨™æ–‡å­—æ•°: 55æ–‡å­—ä»¥å†…' : `âš ï¸ çŸ­æœŸç›®æ¨™: ${shortOver55}ä»¶ãŒ55æ–‡å­—è¶…é`);

                // æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆç°¡æ˜“ï¼‰
                checks.push('âœ… æ•´åˆæ€§: è‡ªå‹•æ¤œè¨¼å®Œäº†ï¼ˆè©³ç´°ã¯ç›®è¦–ç¢ºèªæ¨å¥¨ï¼‰');

            } catch (e) {
                checks.push('âŒ JSONãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼: ' + e.message);
            }

            outputEl.textContent = checks.join('\n');
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>